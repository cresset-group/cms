{% extends "admin/base_site.html" %}

{% block extrastyle %}
  {{ block.super }}

  <style>
    .active-row,
    .active-row:nth-child(odd) {
      background-color: #42cf77;
      color: #fff;
    }

    .active-row a {
      color: #fff;
    }
  </style>
{% endblock %}

{% block content %}
  <div id="content-main" class="inner-two-columns">
    <div class="module filtered initialized" id="changelist">
      <h1>Editing page with draft versions</h1>

      <form method="post">
        <div>
          <fieldset class="module aligned wide">
            <div class="form-row">
              <label class="required" for="id_parent">Parent page</label>
              {{ form.parent }}
            </div>

            <div class="form-row">
              <label class="required" for="id_slug">Slug</label>
              {{ form.slug }}
            </div>
          </fieldset>

          {% csrf_token %}

          <div class="submit-row">
            <button class="button default">Save</button>

            {% if original and original.get_absolute_url %}
              <a href="{{ original.get_absolute_url }}" target="_blank" class="viewsitelink">
                View on site
              </a>
            {% endif %}

            <a href="{% url 'admin:pages_page_delete' original.pk %}" class="deletelink">
              Delete page
            </a>
          </div>
        </div>
      </form>

      <br>

      <h1>Select a version to edit</h1>

      <table>
        <thead>
          <tr>
            <th>
              <div class="text"><span>Version</span></div>
            </th>

            <th>
              <div class="text"><span>Last edited</span></div>
            </th>

            <th>
              <div class="text"><span>Publication status</span></div>
            </th>
          </tr>
        </thead>

        {% for version in page_versions %}
          <tr{% if live_version == version %} class="active-row"{% endif %}>
            <td>
              <a href="{% url 'admin:pages_page_change_version' page=original.pk version=version.version %}">
                {% if version.is_content_object %}
                  Version {{ version.version }}
                {% else %}
                  Original
                {% endif %}
              </a>
            </td>

            <td>{{ version.last_modified }}</td>

            <td>
              {% if live_version == version %}
                Is currently live
              {% else %}
                <a href="{% url 'admin:pages_page_publish_version' page=original.pk version=version.version %}">
                  Make live page
                </a>
              {% endif %}
            </td>
          </tr>
        {% endfor %}
      </table>
    </div>
  </div>
{% endblock %}
